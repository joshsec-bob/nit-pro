{% extends "base.html" %}
{% block content %}
<h2>Top Suspicious IPs</h2>
<table>
  <tr>
    <th>Source IP</th>
    <th>Score</th>
    <th>Status</th>
    <th>Last Update</th>
  </tr>
  {% for r in top_scores %}
  <tr>
    <td>{{ r["src_ip"] }}</td>
    <td>{{ r["score"] }}</td>
    <td class="status-{{ r['status'] }}">{{ r["status"] }}</td>
    <td>{{ r["last_update"] }}</td>
  </tr>
  {% endfor %}
</table>

<h2>Latest Events</h2>
<table>
  <tr>
    <th>ID</th>
    <th>Source IP</th>
    <th>Event Type</th>
    <th>Severity</th>
    <th>Origin</th>
    <th>Timestamp</th>
  </tr>
  {% for e in latest_events %}
  <tr>
    <td>{{ e["id"] }}</td>
    <td>{{ e["src_ip"] }}</td>
    <td>{{ e["event_type"] }}</td>
    <td>{{ e["severity"] }}</td>
    <td>{{ e["origin"] }}</td>
    <td>{{ e["timestamp"] }}</td>
  </tr>
  {% endfor %}
</table>
{% endblock %}
